<div id="modalBackdrop" class="modal-backdrop"></div>
<div id="filterModal" class="filter-modal" tabindex="-1" role="dialog" aria-labelledby="filterModalTitle">
    <div class="filter-modal-content">
        <div class="filter-modal-header">
            <h3 class="filter-modal-title" id="filterModalTitle">Property Filters</h3>
            <button type="button" class="filter-modal-close" onclick="closeModalHandler(event)" aria-label="Close">&times;</button>
        </div>
        <div class="filter-modal-body">
            <div id="filterErrorMessage" class="hidden error-message" style="color: #e53e3e; margin-bottom: 16px; padding: 10px; background-color: #fdf2f2; border-radius: 6px; border-left: 4px solid #e53e3e; display: none;">
                <i class="fa fa-exclamation-circle" style="margin-right: 8px;"></i>
                Please enter a city before applying filters
            </div>
            
            <div style="text-align: right; margin-bottom: 12px;">
                <button type="button" id="resetToAllBtn" class="text-blue-500 hover:text-blue-700 text-sm font-medium" onclick="resetToAllProperties()">
                    <i class="fa fa-refresh" style="margin-right: 4px;"></i> Reset to All Properties
                </button>
            </div>
            
            <div class="property-filter-group">
                <h4 class="property-filter-title">Listing Type</h4>
                <div class="listing-type-toggle">
                    <label class="listing-type-option active" for="listing_sale">
                        <input type="radio" id="listing_sale" name="listing_type_selection" value="sale"
                               class="listing-type-radio" checked>
                        For Sale
                    </label>
                    <label class="listing-type-option" for="listing_rent">
                        <input type="radio" id="listing_rent" name="listing_type_selection" value="rent"
                               class="listing-type-radio">
                        For Rent
                    </label>
                </div>
            </div>

            <input type="hidden" id="activePropertyType" name="activePropertyType" value="all">

            <input type="radio" id="tab_all" name="property_tab" value="all" class="filter-tab-radio" style="display: none;">

            <div class="filter-tabs">
                <label class="filter-tab active" for="tab_residential">
                    <input type="radio" id="tab_residential" name="property_tab" value="residential"
                           class="filter-tab-radio" checked>
                    Residential
                </label>
                <label class="filter-tab" for="tab_commercial">
                    <input type="radio" id="tab_commercial" name="property_tab" value="commercial"
                           class="filter-tab-radio">
                    Commercial
                </label>
                <label class="filter-tab" for="tab_land">
                    <input type="radio" id="tab_land" name="property_tab" value="land"
                           class="filter-tab-radio">
                    Land
                </label>
            </div>

            <div id="allPanel" class="filter-panel">
                <div class="property-filter-group">
                    <h4 class="property-filter-title">Show all available properties</h4>
                </div>
            </div>

            <div id="residentialPanel" class="filter-panel active">
                <div class="property-filter-group">
                    <h4 class="property-filter-title">Property Type</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox"
                                   id="residential_all"
                                   name="residential_type_all"
                                   value="all"
                                   class="residential-type-checkbox select-all"
                                   checked>
                            <label for="residential_all">Select All</label>
                        </div>
                        {% for choice in mainForm.residentialTypes.vars.choices %}
                            <div class="property-filter-option">
                                <input type="checkbox"
                                       id="residential_{{ choice.value }}"
                                       name="residential_type_selection[]"
                                       value="{{ choice.value }}"
                                       class="residential-type-checkbox type-option"
                                       checked>
                                <label for="residential_{{ choice.value }}">{{ choice.label }}</label>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="property-filter-group">
                    <h4 class="property-filter-title">Bedrooms</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="radio" id="bedrooms_any" name="bedrooms" value="" checked>
                            <label for="bedrooms_any">Any</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bedrooms_1" name="bedrooms" value="1">
                            <label for="bedrooms_1">1+</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bedrooms_2" name="bedrooms" value="2">
                            <label for="bedrooms_2">2+</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bedrooms_3" name="bedrooms" value="3">
                            <label for="bedrooms_3">3+</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bedrooms_4" name="bedrooms" value="4">
                            <label for="bedrooms_4">4+</label>
                        </div>
                    </div>
                </div>

                <div class="property-filter-group">
                    <h4 class="property-filter-title">Bathrooms</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="radio" id="bathrooms_any" name="bathrooms" value="" checked>
                            <label for="bathrooms_any">Any</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bathrooms_1" name="bathrooms" value="1">
                            <label for="bathrooms_1">1+</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bathrooms_2" name="bathrooms" value="2">
                            <label for="bathrooms_2">2+</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="radio" id="bathrooms_3" name="bathrooms" value="3">
                            <label for="bathrooms_3">3+</label>
                        </div>
                    </div>
                </div>

                <div class="property-filter-group">
                    <h4 class="property-filter-title">Features</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox" id="features_parking" name="features[]" value="parking">
                            <label for="features_parking">Parking</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="checkbox" id="features_furnished" name="features[]"
                                   value="furnished">
                            <label for="features_furnished">Furnished</label>
                        </div>
                    </div>
                </div>
            </div>

            <div id="commercialPanel" class="filter-panel">
                <div class="property-filter-group">
                    <h4 class="property-filter-title">Property Type</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox"
                                   id="commercial_all"
                                   name="commercial_type_all"
                                   value="all"
                                   class="commercial-type-checkbox select-all"
                                   checked>
                            <label for="commercial_all">Select All</label>
                        </div>
                        {% for choice in mainForm.commercialTypes.vars.choices %}
                            <div class="property-filter-option">
                                <input type="checkbox"
                                       id="commercial_{{ choice.value }}"
                                       name="commercial_type_selection[]"
                                       value="{{ choice.value }}"
                                       class="commercial-type-checkbox type-option"
                                       checked>
                                <label for="commercial_{{ choice.value }}">{{ choice.label }}</label>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="property-filter-group">
                    <h4 class="property-filter-title">Features</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox" id="commercial_parking" name="commercial_features[]"
                                   value="parking">
                            <label for="commercial_parking">Parking</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="checkbox" id="commercial_furnished" name="commercial_features[]"
                                   value="furnished">
                            <label for="commercial_furnished">Furnished</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Land Panel -->
            <div id="landPanel" class="filter-panel">
                <div class="property-filter-group">
                    <h4 class="property-filter-title">Zoning Type</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox"
                                   id="land_all"
                                   name="land_type_all"
                                   value="all"
                                   class="land-type-checkbox select-all"
                                   checked>
                            <label for="land_all">Select All</label>
                        </div>
                        {% for choice in mainForm.landTypes.vars.choices %}
                            <div class="property-filter-option">
                                <input type="checkbox"
                                       id="land_{{ choice.value }}"
                                       name="land_type_selection[]"
                                       value="{{ choice.value }}"
                                       class="land-type-checkbox type-option"
                                       checked>
                                <label for="land_{{ choice.value }}">{{ choice.label }}</label>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="property-filter-group">
                    <h4 class="property-filter-title">Features</h4>
                    <div class="property-filter-options">
                        <div class="property-filter-option">
                            <input type="checkbox" id="land_electricity" name="land_features[]"
                                   value="electricity">
                            <label for="land_electricity">Electricity</label>
                        </div>
                        <div class="property-filter-option">
                            <input type="checkbox" id="land_water" name="land_features[]" value="water">
                            <label for="land_water">Water</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="filter-modal-footer">
            <button type="button" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300"
                    onclick="closeModalHandler(event)">
                Cancel
            </button>
            <button type="button" id="applyFiltersBtn"
                    class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                Apply Filters
            </button>
        </div>
    </div>
</div>

<script>
    function closeModalHandler(event) {
        event.preventDefault();
        event.stopPropagation();
        closeFilterModal();
        
        document.body.style.overflow = 'auto';
        
        return false;
    }
</script>
